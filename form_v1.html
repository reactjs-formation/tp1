<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello React</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>

  </head>
  <body>
    <div id="root"></div>
    <!-- compilation JSX => JS -->
    <script type="text/babel">

    const questions = {
        'symfony' : {
            title : "Symfony utilise quel design pattern ?",
            choices : ['MMV', 'MVC', 'MMVV'],
            response : 1,
            type : "select",
            name : "symfony",
            feedback : 'Symfony est basé sur le pattern MVC'
        },
        'react' : {
            title : "React est-il un framework ?",
            choices : ['yes', 'no'],
            response : 1,
            type : "radio",
            name : "react",
            feedback : "React est une librairie"
        },
        'jsx' : {
            title : "JSX c'est quoi ?",
            choices : ['JSX est un langage compilé', 'JSX est un sur-ensemble développé par Facebook'],
            response : 1,
            type: "radio" ,
            name : "jsx",
            feedback : 'JSX est un sur ensemble à JS'
        }
    }


    class Wrapper extends React.Component{
      render(){
        return(
          <div>{this.props.children}</div>
        )
      }
    }

    class Form extends React.Component{

      constructor(props) {
        super(props)
        this.state = {
          questions: questions
        }
      }

      hChange = (e) => {
        console.log('hChange', e.target, e.target.value)
      }
        
      render(){
        
        return(
          <form>
            <Wrapper index={0} key={0}>
              <h1>QCM React</h1>
              <label htmlFor="test">votre email (*) : </label>
              <Input id="test" />
              <button type="submit">Valider</button>
            </Wrapper>
            {
              Object.entries(this.state.questions).map((elm,i) => {

                // q pour question
                const q = elm[1];
                return (
                  <Wrapper key={i+1}>
                    {q.type === 'select' ? 
                      <Select {...q} num={i} hChange={this.hChange} />
                      :
                      q.type === 'radio' ? 
                        <Radio {...q} num={i} hChange={this.hChange} /> 
                        : 
                        <div></div>
                    }
                    <button type="submit">Valider</button>
                  </Wrapper>
                )
              })
            }
            
          </form>
        )
      }
    }

    class Input extends React.Component{
        
      render(){
        return(
          <input type="text" id={this.props.id} />
        )
      }
    }

    class Select extends React.Component{
        
      render(){
        return(
          <div>
            <h2>
              <label htmlFor="">{this.props.title}</label>
            </h2>
            <select key={this.props.key} onChange={this.props.hChange}>
              {
                this.props.choices.map((elm, i) => {
                  return (
                    <option key={i}>{elm}</option>
                  )
                })
              }
            </select>
          </div>
        )
      }
    }
    class Radio extends React.Component{
        
      render(){
        return(
          <div>
            <h2>{this.props.title}</h2>
            {
              this.props.choices.map((elm, i ) => {
                return (
                  <div key={i}>
                    <label htmlFor="">{elm}</label>
                    <input type="radio" value={elm} onChange={this.props.hChange} />
                  </div>
                )
              })
            }
          </div>
        )
      }
    }
    class File extends React.Component{
        
      render(){
        return(
          <div></div>
        )
      }
    }

    // Rendu dans le DOM
    ReactDOM.render(<Form/>,document.getElementById('root'));

    </script>
  </body>
</html>
